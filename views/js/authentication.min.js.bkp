function signUpWithEmailVerification() { handleSignUp() } function signIn() { toggleSignIn() } function toggleSignIn() { var e = document.getElementById("login_email").value, a = document.getElementById("login_password").value; e.length < 4 ? alert("Please enter an email address.") : a.length < 4 ? alert("Please enter a password.") : firebase.auth().signInWithEmailAndPassword(e, a).then(function () { loginToApp() }).catch(function (e) { var a = e.code, t = e.message; "auth/wrong-password" === a ? alert("Wrong password.") : alert(t) }) } function handleSignUp() { var e = document.getElementById("email").value, a = document.getElementById("password").value; e.length < 4 ? alert("Please enter an email address.") : a.length < 4 ? alert("Please enter a password.") : firebase.auth().createUserWithEmailAndPassword(e, a).then(function () { initApp() }).catch(function (e) { var a = e.code, t = e.message; a && (response = a), "auth/weak-password" == a ? alert("The password is too weak.") : alert(t) }) } function sendPasswordReset() { var e = document.getElementById("email").value; firebase.auth().sendPasswordResetEmail(e).then(function () { alert("Password Reset Email Sent!") }).catch(function (e) { var a = e.code, t = e.message; "auth/invalid-email" == a ? alert(t) : "auth/user-not-found" == a && alert(t) }) } function initApp() { firebase.auth().onAuthStateChanged(function (e) { e ? e.emailVerified ? alert("Your email is already verified!Please login with the email") : (currentUser = e, firebase.auth().currentUser.sendEmailVerification().then(function () { firebase.auth().currentUser.getIdToken(!0).then(function (e) { var a; a = e, $.ajax({ url: "validateToken", type: "POST", data: { idToken: a, restaurantName: $("#restaurantname").val(), tableCount: $("#noftables").val(), firstname: $("#firstname").val(), lastname: $("#lastname").val() }, success: function (e) { "success" == e ? window.location.href = "/dashboard" : alert("Issue while validating Token") }, error: function (e) { alert(e) } }) }).catch(function (e) { e.code, e.message }) }).catch(function (e) { firebase.auth().currentUser.delete().then(function () { }).catch(function (e) { }) })) : alert("Email is not exist!Please use Valid Email") }) } function loginToApp() { firebase.auth().onAuthStateChanged(function (e) { e ? e.emailVerified ? (currentUser = e, firebase.auth().currentUser.getIdToken(!0).then(function (e) { $("div.main-login").append('<input name="idToken" id="idToken" value=' + e + ' type="hidden"/>'), addSubmitForm() }).catch(function (e) { e.code, e.message })) : alert("Email is not verified!Please verify your email") : alert("Email is not Exist!Please use Valid Email") }) } function addSubmitForm() { $("div.main-login").wrap('<form id="loginForm" name="loginForm">'); var e = $("#loginForm").get(0); e.action = "login", e.method = "POST", e.submit() } $(document).ready(function () { firebase.initializeApp({ apiKey: "AIzaSyDqdpDVJ5cnTMcn0N_Jq4XXWYLpqVXEQJY", authDomain: "test-6d54b.firebaseapp.com", databaseURL: "https://test-6d54b.firebaseio.com", projectId: "test-6d54b", storageBucket: "test-6d54b.appspot.com", messagingSenderId: "27004136578" }) });